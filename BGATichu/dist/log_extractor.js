(()=>{"use strict";var t={699:t=>{const o=/A new round starts/i,e=/consecutive doubles from (\d{1,2}|\w)\w* to (\d{1,2}|\w)/i,r=/plays Pair of (\d{1,2}|\w)/i,s=/plays Triple of (\d{1,2}|\w)/i,n=/plays Run of \d+ cards from (\d{1,2}|\w)\w* to (\d{1,2}|\w)/i,l=/plays (\d{1,2}|\w)\w*'?s? full of (\d{1,2}|\w)\w*'?s?/i,a=/plays Bomb of four (\d{1,2}|\w)/i,u=/plays Straight flush bomb starting from (\d{1,2}|\w)\w* to (\d{1,2}|\w)/i,d=/plays (\d{1,2}|dragon|dog|[a-z])/i,i=["2","3","4","5","6","7","8","9","10","J","Q","K","A"];t.exports=class{constructor(){this.cardsUsed=new Map}getCardsUsed(){return this.cardsUsed}getSinglePlayCards(t){let o=t.match(d);if(null==o)return[];if(o.length>2)return console.log("Found too many matches "+t),[];let e=o[1];return console.log("found single "+e),[e]}getPairPlayCards(t){let o=t.match(r);return null==o?[]:o.length>2?(console.log("Found too many matches "+t),[]):(console.log("found pair "+o[1]),[o[1],o[1]])}getTriplePlayCards(t){let o=t.match(s);return null==o?[]:o.length>2?(console.log("Found too many matches "+t),[]):(console.log("found triple "+o[1]),[o[1],o[1],o[1]])}getQuadBombCards(t){let o=t.match(a);if(null==o)return[];if(o.length>2)return console.log("Found too many matches "+t),[];const e=o[1];return console.log("found quad "+e+" bomb"),[e,e,e,e]}getConsecutivePairsCards(t){let o=t.match(e);if(null==o)return[];if(o.length>3)return console.log("Found too many matches "+t),[];console.log("found pairs "+o[1]+" to "+o[2]);var r=[],s=!1;for(var n of i)if(s||n!=o[1]||(s=!0),s&&(r.push(n),r.push(n)),n==o[2])break;return r}getStraightCards(t){let o=t.match(n);if(null==o)return[];if(o.length>3)return console.log("Found too many matches "+t),[];const e=o[1],r=o[2];console.log("found straight "+e+" to "+r);var s=[],l=!1;for(var a of i)if(l||a!=e||(l=!0),l&&s.push(a),a==r)break;return s}getStraightBombCards(t){let o=t.match(u);if(null==o)return[];if(o.length>3)return console.log("Found too many matches "+t),[];const e=o[1],r=o[2];console.log("found straight bomb "+e+" to "+r);var s=[],n=!1;for(var l of i)if(n||l!=e||(n=!0),n&&s.push(l),l==r)break;return s}getFullHouseCards(t){let o=t.match(l);if(null==o)return[];if(o.length>3)return console.log("Found too many matches "+t),[];const e=o[1],r=o[2];return console.log("found full house 3 "+e+" and 2 "+r),[e,e,e,r,r]}processLogText(t){var e;if(o.test(t))return this.cardsUsed.clear(),void console.log("Reseting card counts");let r=this.getConsecutivePairsCards(t);0==r.length&&(r=this.getPairPlayCards(t)),0==r.length&&(r=this.getTriplePlayCards(t)),0==r.length&&(r=this.getStraightCards(t)),0==r.length&&(r=this.getFullHouseCards(t)),0==r.length&&(r=this.getQuadBombCards(t)),0==r.length&&(r=this.getStraightBombCards(t)),0==r.length&&(r=this.getSinglePlayCards(t)),console.log("Found cards: "+r);for(let t of r)this.cardsUsed.set(t,(null!==(e=this.cardsUsed.get(t))&&void 0!==e?e:0)+1)}}}},o={};!function e(r){var s=o[r];if(void 0!==s)return s.exports;var n=o[r]={exports:{}};return t[r](n,n.exports,e),n.exports}(699)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TVIsU0FDTlEsRUFBUVosS0FBS2UsaUJBQWlCYixJQUVkLEdBQWhCVSxFQUFNUixTQUNOUSxFQUFRWixLQUFLbUIsa0JBQWtCakIsSUFFZixHQUFoQlUsRUFBTVIsU0FDTlEsRUFBUVosS0FBS1MsaUJBQWlCUCxJQUVkLEdBQWhCVSxFQUFNUixTQUNOUSxFQUFRWixLQUFLa0IscUJBQXFCaEIsSUFFbEIsR0FBaEJVLEVBQU1SLFNBQ05RLEVBQVFaLEtBQUtDLG1CQUFtQkMsSUFFcENHLFFBQVFILElBQUksZ0JBQWtCVSxHQUM5QixJQUFLLElBQUlOLEtBQVFNLEVBQ2JaLEtBQUtILFVBQVU0QixJQUFJbkIsR0FBK0IsUUFBeEIsRUFBQU4sS0FBS0gsVUFBVTZCLElBQUlwQixVQUFLLFFBQUksR0FBSyxFQUVuRSxFLEdDOU5BcUIsRUFBMkIsQ0FBQyxHQUdoQyxTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCRSxJQUFqQkQsRUFDSCxPQUFPQSxFQUFhRSxRQUdyQixJQUFJQyxFQUFTTixFQUF5QkUsR0FBWSxDQUdqREcsUUFBUyxDQUFDLEdBT1gsT0FIQUUsRUFBb0JMLEdBQVVJLEVBQVFBLEVBQU9ELFFBQVNKLEdBRy9DSyxFQUFPRCxPQUNmLENDbkIwQkosQ0FBb0IsSSIsInNvdXJjZXMiOlsid2VicGFjazovL21lZGl1bS1leHRlbnNpb24vLi9zY3JpcHRzL2xvZ19leHRyYWN0b3IudHMiLCJ3ZWJwYWNrOi8vbWVkaXVtLWV4dGVuc2lvbi93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9tZWRpdW0tZXh0ZW5zaW9uL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBuZXdSb3VuZFJFID0gL0EgbmV3IHJvdW5kIHN0YXJ0cy9pXG5jb25zdCBwbGF5c0NvbnNlY3V0aXZlUGFpcnNSRSA9IC9jb25zZWN1dGl2ZSBkb3VibGVzIGZyb20gKFxcZHsxLDJ9fFxcdylcXHcqIHRvIChcXGR7MSwyfXxcXHcpL2lcbmNvbnN0IHBsYXlzUGFpcnNSRSA9IC9wbGF5cyBQYWlyIG9mIChcXGR7MSwyfXxcXHcpL2lcbmNvbnN0IHBsYXlzVHJpcGxlc1JFID0gL3BsYXlzIFRyaXBsZSBvZiAoXFxkezEsMn18XFx3KS9pXG5jb25zdCBwbGF5c1N0cmFpZ2h0UkUgPSAvcGxheXMgUnVuIG9mIFxcZCsgY2FyZHMgZnJvbSAoXFxkezEsMn18XFx3KVxcdyogdG8gKFxcZHsxLDJ9fFxcdykvaVxuY29uc3QgcGxheXNGdWxsSG91c2VSRSA9IC9wbGF5cyAoXFxkezEsMn18XFx3KVxcdyonP3M/IGZ1bGwgb2YgKFxcZHsxLDJ9fFxcdylcXHcqJz9zPy9pXG5jb25zdCBwbGF5c1F1YWRCb21iUkUgPSAvcGxheXMgQm9tYiBvZiBmb3VyIChcXGR7MSwyfXxcXHcpL2lcbmNvbnN0IHBsYXlzU3RyYWlnaHRCb21iUkUgPSAvcGxheXMgU3RyYWlnaHQgZmx1c2ggYm9tYiBzdGFydGluZyBmcm9tIChcXGR7MSwyfXxcXHcpXFx3KiB0byAoXFxkezEsMn18XFx3KS9pXG5jb25zdCBwbGF5c1NpbmdsZVJFID0gL3BsYXlzIChcXGR7MSwyfXxkcmFnb258ZG9nfFthLXpdKS9pXG5cbmNvbnN0IGNhcmRzUmFua2VkID0gW1wiMlwiLCBcIjNcIiwgXCI0XCIsIFwiNVwiLCBcIjZcIiwgXCI3XCIsIFwiOFwiLCBcIjlcIiwgXCIxMFwiLCBcIkpcIiwgXCJRXCIsIFwiS1wiLCBcIkFcIl07XG5cbmV4cG9ydCA9IExvZ0V4dHJhY3RvcjtcblxuY2xhc3MgTG9nRXh0cmFjdG9yIHtcbiAgICBwcml2YXRlIGNhcmRzVXNlZCA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG4gICAgZ2V0Q2FyZHNVc2VkKCk6IE1hcDxzdHJpbmcsIG51bWJlcj4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jYXJkc1VzZWQ7XG4gICAgfVxuICAgIGdldFNpbmdsZVBsYXlDYXJkcyhsb2c6IHN0cmluZyk6IHN0cmluZ1tdIHtcblxuICAgICAgICBsZXQgbWF0Y2ggPSBsb2cubWF0Y2gocGxheXNTaW5nbGVSRSk7XG5cbiAgICAgICAgaWYgKG1hdGNoID09IG51bGwpIHsgcmV0dXJuIFtdOyB9XG5cbiAgICAgICAgaWYgKG1hdGNoLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRm91bmQgdG9vIG1hbnkgbWF0Y2hlcyBcIiArIGxvZylcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgY2FyZCA9IG1hdGNoWzFdXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZm91bmQgc2luZ2xlIFwiICsgY2FyZCk7XG4gICAgICAgIHJldHVybiBbY2FyZF07XG4gICAgfVxuXG4gICAgZ2V0UGFpclBsYXlDYXJkcyhsb2c6IHN0cmluZyk6IHN0cmluZ1tdIHtcblxuICAgICAgICBsZXQgbWF0Y2ggPSBsb2cubWF0Y2gocGxheXNQYWlyc1JFKTtcblxuICAgICAgICBpZiAobWF0Y2ggPT0gbnVsbCkgeyByZXR1cm4gW107IH1cblxuICAgICAgICBpZiAobWF0Y2gubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJGb3VuZCB0b28gbWFueSBtYXRjaGVzIFwiICsgbG9nKVxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJmb3VuZCBwYWlyIFwiICsgbWF0Y2hbMV0pO1xuICAgICAgICByZXR1cm4gW21hdGNoWzFdLCBtYXRjaFsxXV07XG4gICAgfVxuXG4gICAgZ2V0VHJpcGxlUGxheUNhcmRzKGxvZzogc3RyaW5nKTogc3RyaW5nW10ge1xuXG4gICAgICAgIGxldCBtYXRjaCA9IGxvZy5tYXRjaChwbGF5c1RyaXBsZXNSRSk7XG5cbiAgICAgICAgaWYgKG1hdGNoID09IG51bGwpIHsgcmV0dXJuIFtdOyB9XG5cbiAgICAgICAgaWYgKG1hdGNoLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRm91bmQgdG9vIG1hbnkgbWF0Y2hlcyBcIiArIGxvZylcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZm91bmQgdHJpcGxlIFwiICsgbWF0Y2hbMV0pO1xuICAgICAgICByZXR1cm4gW21hdGNoWzFdLCBtYXRjaFsxXSwgbWF0Y2hbMV1dO1xuICAgIH1cblxuICAgIGdldFF1YWRCb21iQ2FyZHMobG9nOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG5cbiAgICAgICAgbGV0IG1hdGNoID0gbG9nLm1hdGNoKHBsYXlzUXVhZEJvbWJSRSk7XG5cbiAgICAgICAgaWYgKG1hdGNoID09IG51bGwpIHsgcmV0dXJuIFtdOyB9XG5cbiAgICAgICAgaWYgKG1hdGNoLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRm91bmQgdG9vIG1hbnkgbWF0Y2hlcyBcIiArIGxvZylcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBib21iID0gbWF0Y2hbMV07XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJmb3VuZCBxdWFkIFwiICsgYm9tYiArIFwiIGJvbWJcIik7XG4gICAgICAgIHJldHVybiBbYm9tYiwgYm9tYiwgYm9tYiwgYm9tYl07XG4gICAgfVxuXG5cblxuICAgIGdldENvbnNlY3V0aXZlUGFpcnNDYXJkcyhsb2c6IHN0cmluZyk6IHN0cmluZ1tdIHtcblxuICAgICAgICBsZXQgbWF0Y2ggPSBsb2cubWF0Y2gocGxheXNDb25zZWN1dGl2ZVBhaXJzUkUpO1xuXG4gICAgICAgIGlmIChtYXRjaCA9PSBudWxsKSB7IHJldHVybiBbXTsgfVxuXG4gICAgICAgIGlmIChtYXRjaC5sZW5ndGggPiAzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZvdW5kIHRvbyBtYW55IG1hdGNoZXMgXCIgKyBsb2cpXG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZyhcImZvdW5kIHBhaXJzIFwiICsgbWF0Y2hbMV0gKyBcIiB0byBcIiArIG1hdGNoWzJdKTtcbiAgICAgICAgdmFyIGNhcmRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICB2YXIgcmVjb3JkID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGNhcmQgb2YgY2FyZHNSYW5rZWQpIHtcbiAgICAgICAgICAgIGlmICghcmVjb3JkICYmIGNhcmQgPT0gbWF0Y2hbMV0pIHtcbiAgICAgICAgICAgICAgICByZWNvcmQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlY29yZCkge1xuICAgICAgICAgICAgICAgIGNhcmRzLnB1c2goY2FyZCk7XG4gICAgICAgICAgICAgICAgY2FyZHMucHVzaChjYXJkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjYXJkID09IG1hdGNoWzJdKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhcmRzO1xuICAgIH1cblxuICAgIGdldFN0cmFpZ2h0Q2FyZHMobG9nOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG5cbiAgICAgICAgbGV0IG1hdGNoID0gbG9nLm1hdGNoKHBsYXlzU3RyYWlnaHRSRSk7XG5cbiAgICAgICAgaWYgKG1hdGNoID09IG51bGwpIHsgcmV0dXJuIFtdOyB9XG5cbiAgICAgICAgaWYgKG1hdGNoLmxlbmd0aCA+IDMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRm91bmQgdG9vIG1hbnkgbWF0Y2hlcyBcIiArIGxvZylcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbWF0Y2hbMV07XG4gICAgICAgIGNvbnN0IGVuZCA9IG1hdGNoWzJdO1xuICAgICAgICBjb25zb2xlLmxvZyhcImZvdW5kIHN0cmFpZ2h0IFwiICsgc3RhcnQgKyBcIiB0byBcIiArIGVuZCk7XG4gICAgICAgIHZhciBjYXJkczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgdmFyIHJlY29yZCA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBjYXJkIG9mIGNhcmRzUmFua2VkKSB7XG4gICAgICAgICAgICBpZiAoIXJlY29yZCAmJiBjYXJkID09IHN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgcmVjb3JkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZWNvcmQpIHtcbiAgICAgICAgICAgICAgICBjYXJkcy5wdXNoKGNhcmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNhcmQgPT0gZW5kKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhcmRzO1xuICAgIH1cblxuICAgIGdldFN0cmFpZ2h0Qm9tYkNhcmRzKGxvZzogc3RyaW5nKTogc3RyaW5nW10ge1xuXG4gICAgICAgIGxldCBtYXRjaCA9IGxvZy5tYXRjaChwbGF5c1N0cmFpZ2h0Qm9tYlJFKTtcblxuICAgICAgICBpZiAobWF0Y2ggPT0gbnVsbCkgeyByZXR1cm4gW107IH1cblxuICAgICAgICBpZiAobWF0Y2gubGVuZ3RoID4gMykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJGb3VuZCB0b28gbWFueSBtYXRjaGVzIFwiICsgbG9nKVxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc3RhcnQgPSBtYXRjaFsxXTtcbiAgICAgICAgY29uc3QgZW5kID0gbWF0Y2hbMl07XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZm91bmQgc3RyYWlnaHQgYm9tYiBcIiArIHN0YXJ0ICsgXCIgdG8gXCIgKyBlbmQpO1xuICAgICAgICB2YXIgY2FyZHM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIHZhciByZWNvcmQgPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgY2FyZCBvZiBjYXJkc1JhbmtlZCkge1xuICAgICAgICAgICAgaWYgKCFyZWNvcmQgJiYgY2FyZCA9PSBzdGFydCkge1xuICAgICAgICAgICAgICAgIHJlY29yZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVjb3JkKSB7XG4gICAgICAgICAgICAgICAgY2FyZHMucHVzaChjYXJkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjYXJkID09IGVuZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYXJkcztcbiAgICB9XG5cbiAgICBnZXRGdWxsSG91c2VDYXJkcyhsb2c6IHN0cmluZyk6IHN0cmluZ1tdIHtcblxuICAgICAgICBsZXQgbWF0Y2ggPSBsb2cubWF0Y2gocGxheXNGdWxsSG91c2VSRSk7XG5cbiAgICAgICAgaWYgKG1hdGNoID09IG51bGwpIHsgcmV0dXJuIFtdOyB9XG5cbiAgICAgICAgaWYgKG1hdGNoLmxlbmd0aCA+IDMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRm91bmQgdG9vIG1hbnkgbWF0Y2hlcyBcIiArIGxvZylcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRyaXBsZSA9IG1hdGNoWzFdO1xuICAgICAgICBjb25zdCBkb3VibGUgPSBtYXRjaFsyXTtcbiAgICAgICAgY29uc29sZS5sb2coXCJmb3VuZCBmdWxsIGhvdXNlIDMgXCIgKyB0cmlwbGUgKyBcIiBhbmQgMiBcIiArIGRvdWJsZSk7XG5cbiAgICAgICAgcmV0dXJuIFt0cmlwbGUsIHRyaXBsZSwgdHJpcGxlLCBkb3VibGUsIGRvdWJsZV07XG4gICAgfVxuXG5cbiAgICBwcm9jZXNzTG9nVGV4dChsb2c6IHN0cmluZykge1xuICAgICAgICBpZiAobmV3Um91bmRSRS50ZXN0KGxvZykpIHtcbiAgICAgICAgICAgIHRoaXMuY2FyZHNVc2VkLmNsZWFyKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc2V0aW5nIGNhcmQgY291bnRzXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGNhcmRzID0gdGhpcy5nZXRDb25zZWN1dGl2ZVBhaXJzQ2FyZHMobG9nKTtcbiAgICAgICAgaWYgKGNhcmRzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjYXJkcyA9IHRoaXMuZ2V0UGFpclBsYXlDYXJkcyhsb2cpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYXJkcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgY2FyZHMgPSB0aGlzLmdldFRyaXBsZVBsYXlDYXJkcyhsb2cpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYXJkcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgY2FyZHMgPSB0aGlzLmdldFN0cmFpZ2h0Q2FyZHMobG9nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FyZHMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIGNhcmRzID0gdGhpcy5nZXRGdWxsSG91c2VDYXJkcyhsb2cpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYXJkcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgY2FyZHMgPSB0aGlzLmdldFF1YWRCb21iQ2FyZHMobG9nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FyZHMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIGNhcmRzID0gdGhpcy5nZXRTdHJhaWdodEJvbWJDYXJkcyhsb2cpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYXJkcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgY2FyZHMgPSB0aGlzLmdldFNpbmdsZVBsYXlDYXJkcyhsb2cpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRm91bmQgY2FyZHM6IFwiICsgY2FyZHMpO1xuICAgICAgICBmb3IgKGxldCBjYXJkIG9mIGNhcmRzKSB7XG4gICAgICAgICAgICB0aGlzLmNhcmRzVXNlZC5zZXQoY2FyZCwgKHRoaXMuY2FyZHNVc2VkLmdldChjYXJkKSA/PyAwKSArIDEpO1xuICAgICAgICB9XG4gICAgfVxufSIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNjk5KTtcbiJdLCJuYW1lcyI6WyJuZXdSb3VuZFJFIiwicGxheXNDb25zZWN1dGl2ZVBhaXJzUkUiLCJwbGF5c1BhaXJzUkUiLCJwbGF5c1RyaXBsZXNSRSIsInBsYXlzU3RyYWlnaHRSRSIsInBsYXlzRnVsbEhvdXNlUkUiLCJwbGF5c1F1YWRCb21iUkUiLCJwbGF5c1N0cmFpZ2h0Qm9tYlJFIiwicGxheXNTaW5nbGVSRSIsImNhcmRzUmFua2VkIiwiY2FyZHNVc2VkIiwiTWFwIiwiZ2V0Q2FyZHNVc2VkIiwidGhpcyIsImdldFNpbmdsZVBsYXlDYXJkcyIsImxvZyIsIm1hdGNoIiwibGVuZ3RoIiwiY29uc29sZSIsImNhcmQiLCJnZXRQYWlyUGxheUNhcmRzIiwiZ2V0VHJpcGxlUGxheUNhcmRzIiwiZ2V0UXVhZEJvbWJDYXJkcyIsImJvbWIiLCJnZXRDb25zZWN1dGl2ZVBhaXJzQ2FyZHMiLCJjYXJkcyIsInJlY29yZCIsInB1c2giLCJnZXRTdHJhaWdodENhcmRzIiwic3RhcnQiLCJlbmQiLCJnZXRTdHJhaWdodEJvbWJDYXJkcyIsImdldEZ1bGxIb3VzZUNhcmRzIiwidHJpcGxlIiwiZG91YmxlIiwicHJvY2Vzc0xvZ1RleHQiLCJ0ZXN0IiwiY2xlYXIiLCJzZXQiLCJnZXQiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyJdLCJzb3VyY2VSb290IjoiIn0=